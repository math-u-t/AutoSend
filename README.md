タイトル

チャット自動送信

著者名

math-u-t

目的

標準の Googleチャット には、時間を指定して送信する機能が存在しません。

そのため、GASを使用して自動送信システムを作成しました。

背景

学校、会社などで使用している Googleチャット をより便利にするため

既存のものとの相違点

似たようなものがあるが、 Googleフォーム を使用して詳細な時間設定が可能。

また、WebhookURLを指定することで様々なチャットに送信することができます。

関数の説明

send_Scheduled_Messages()

メイン関数 1分ごとにトリガーで実行させることで、スプレッドシートに保存されたデータを確認する。

send_Custom_Email()

エラーメッセージを細かく場合分けした関数。

文字数が4000文字以上の場合:送信内容が4000文字を超えています。送信内容を短くしてください。

送信予定時間が過去の場合:送信予定時間が過去(2分前より過去）です。送信予定時間は未来になるようにしてください。

送信予定時間が1ヶ月以上先の場合:送信予定時間が1か月以上先です。送信予定時間は1か月よりも最近にしてください。

処理が終了すると、スプレッドシートの送信済みチェックがつく。

send_Error_Email()

エラーメッセージを送信する関数。なお、送信する際、表示する名前は「予約の確認（自動）」で、タイトルは「予約できませんでした」。

予約が不可能な場合の送信メッセージ

詳細：＜送信が不可能な理由＞

もう一度予約を行ってください。

このメッセージは自動送信されています。

返信しないでください。

create_Email_Content()

エラーメッセージを送信する関数。なお、送信する際、表示する名前は「予約の確認（自動）」で、タイトルは「自動送信予約の詳細」。

予約が可能な場合の送信メッセージ

予約者 : ＜メールアドレス＞

送信内容 : ＜送信する予定の内容＞

送信予定時間 : ＜送信する予定の時間＞

webhookURL : ＜送信するWebhookURL＞

予約コード : ＜未完成なため、現在特に機能はなし。送信取り消し機能などをつける予定＞

予約が完了しました。

ご利用ありがとうございます。

このメッセージは自動で送信されています。

返信しないでください。

format_Date()

日付を変換する関数

データを入力すると、

＜年＞-＜月＞-＜日＞ ＜時＞:＜分＞:＜秒＞

の形でデータが返される。

generate_Random_Code()

予約コードを生成する関数。

abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789の中から、指定された文字の長さ分のランダムコードを返す。

generalization_send_Email()

送信関数の一般化関数。メールの記事を作成する。

運用方法

以下の方法で全く同じものが作成できます。
